# -*- coding: utf-8 -*-

class Player(object):
    def set_hand(self, hand):
        self.hand = hand
        self.rank = _rank(self.values, self.suits)
        self.values, self.suits = _hand_to_vs(hand)

    def __gt__(self, other):
        return self.rank > other.rank

    def __lt__(self, other):
        return self.rank < other.rank

    def __eq__(self, other):
        return self.rank == other.rank

    def __str__(self):
        self.hand = _vs_to_hand(self.values, self.suits)
        return self.hand

    def __repr__(self):
        self.hand = _vs_to_hand(self.values, self.suits)
        return self.hand

# hand <==> values, suits
def _hand_to_vs(hand):
    #値は手(hand)を関数で評価した時に返り値として返すのに用いる
    #0(False)は条件を満たさない場合の返り値として使うので、1からはじめる
    card_to_num = {"2":1, "3":2, "4":3, "5":4, "6":5, "7":6, "8":7, "9":8, "T":9, "J":10, "Q":11, "K":12, "A":13}
    values = [card_to_num[i] for i in hand[::2]]
    suits = [i for i in hand[1::2]]
    return values, suits

def _vs_to_hand(values, suits):
    num_to_hand = {1:"2", 2:"3", 3:"4", 4:"5", 5:"6", 6:"7", 7:"8", 8:"9", 9:"T", 10:"J", 11:"Q", 12:"K", 13:"A"}
    hand = ""
    for i in range(5):
        hand.append(num_to_hand[values[i]] + suits[i])
    return hand

# rank
def _rank(values, suits):
    v, s = values, suits
    rank = [0]*10
    rank[0] = _royal_flush(v, s)
    rank[1] = _straight_flush(v, s)
    rank[2] = _four_of_a_kind(v)
    rank[3] = _full_house(v)
    rank[4] = _flush(s)
    rank[5] = _straight(v)
    rank[6] = _three_of_a_kind(v)
    rank[7] = _two_pairs(v)
    rank[8] = _one_pair(v)
    rank[9] = _high_card(v)
    return rank

# rank-0
def _high_card(values):
    return max(values)

# rank-1
def _pair(values, pairs, per_pair):
    dic = {}
    for i in values:
        dic[i] = values.count(i)
    
    count, L = 0, []
    for k, v in dic.items():
        #組あたりper_pair枚
        if v == per_pair:
            count += 1
            L.append(k)
    L.sort(reverse=True)
    
    #ペアの数がpairs組
    if count == pairs:
        if pairs == 1:
            return L.max()
        else:
            return L
    else:
        return False

# rank-2
def _one_pair(values):
    return _pair(values, 1, 2)

# rank-3
def _two_pairs(values):
    return _pair(values, 2, 2)

# rank-4
def _three_of_a_kind(values):
    return _pair(values, 1, 3)

# rank-5
def _straight(values):
    st = [range(i, i+5) for i in range(1, 9)]
    v = values
    v.sort()
    if v in st:
        return v[0]
    else:
        return False

# rank-6
def _flush(suits):
    if suits[0] == suits[1] == suits[2] == suits[3] == suits[4]:
        return True
    else:
        return False

# rank-7
def _full_house(values):
    #TODO: two -> one??
    if _three_of_a_kind(values) and _two_pairs(values):
        return (_three_of_a_kind(values), _two_pairs(values))
    else:
        return False

# rank-8
def _four_of_a_kind(values):
    return _pair(values, 1, 4)

# rank-9
def _straight_flush(values, suits):
    if (not _royal_flush(values, suits)) and _straight(values) and _flush(suits):
        return _straight(values)
    else:
        return False

# rank-10
def _royal_flush(values, suits):
    v = values
    v.sort()
    if v == [9, 10, 11, 12, 13] and _flush(suits):
        return True
    else:
        return False
